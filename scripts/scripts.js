"use strict";function slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}var config={apiKey:"AIzaSyBL9UCwkTeWzbPazNed-bkPQpx1_imxz84",authDomain:"graphical-reasoner.firebaseapp.com",databaseURL:"https://graphical-reasoner.firebaseio.com",storageBucket:"graphical-reasoner.appspot.com"};firebase.initializeApp(config),angular.module("atheistengineergithubioApp",["ngAnimate","ngtweet","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngVis","ui.bootstrap","xeditable","firebase"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/twitter",{templateUrl:"views/twitter.html",controller:"TwitterCtrl",controllerAs:"twitter"}).when("/reason",{templateUrl:"views/reason.html",controller:"ReasonCtrl",controllerAs:"reason",reloadOnSearch:!1,resolve:{currentAuth:["Auth",function(e){return e.$waitForSignIn()}]}}).otherwise({redirectTo:"/"})}]).run(["editableOptions",function(e){e.theme="bs3"}]),angular.module("atheistengineergithubioApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("atheistengineergithubioApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("atheistengineergithubioApp").controller("TwitterCtrl",["$scope","$routeParams",function(e,t){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],e.timelines={me:["My Tweets","737369040692367360"],celebrities:["Atheist Celebrities","737415513077362688"],evolution:["Evolution","737416906966204416"],organizations:["Organizations","737415726059917316"],podcasts:["Smart Podcasts","737412950714134528"],space:["Space Content","737415216791707648"],"science-deniers":["Science Deniers","737409885277683716"],scientists:["Scientists","737412701144666112"]};var r=t.ref;void 0===e.timelines[r]&&(r="me"),e.timeline_id=e.timelines[r][1],e.isActive=function(e){return e===r}}]),angular.module("atheistengineergithubioApp").controller("ReasonCtrl",["$scope","$routeParams","$location","$firebaseArray","$firebaseObject","Auth","Reason","VisDataSet","Firebase",function(e,t,r,o,n,a,s,i,d){function l(t){var r=s(t,e.auth.uid);return r.then(function(t){e.graph=t,t.$bindTo(e,"graph"),t.$loaded().then(function(e){void 0!==e.nodes&&c.add(e.nodes),void 0!==e.edges&&h.add(t.edges)}),c.on("*",function(){e.graph.nodes=c.get()}),h.on("*",function(){e.graph.edges=h.get()})}),r}function g(t,o){if(void 0===t.nodes&&(t.nodes=[]),e.selectedNodes=t.nodes,e.selectedNodeObjects=e.graphData.nodes.get(t.nodes),void 0===t.edges&&(t.edges=[]),e.selectedEdges=t.edges,e.selectedEdgeObjects=e.graphData.edges.get(t.edges),r.search({name:e.graph.name,edge:t.edges,node:t.nodes}),t.edges.length>0&&(e.supportedNode=e.graphData.nodes.get(t.edges[0].to),e.supportingNode=e.graphData.nodes.get(t.edges[0].from)),t.nodes.length>0){var n=e.graphData.edges.get({filter:function(e){return t.nodes.indexOf(e.to.toString())>=0}}),a=$.map(n,function(e){return e.from});e.supportingNodes=e.graphData.nodes.get(a);var s=e.graphData.edges.get({filter:function(e){return t.nodes.indexOf(e.from.toString())>=0}}),i=$.map(s,function(e){return e.to});e.supportedNodes=e.graphData.nodes.get(i)}else e.supportedNodes=[],e.supportingNodes=[];o!==!0&&e.$apply()}if(e.auth=a,e.firebaseUser=null,void 0!==r.search().name){var u=r.search().name;l(u)}var c=new i,h=new i;e.graphData={nodes:c,edges:h},e.graph={},e.graphEditable=function(t){return null!==e.firebaseUser&&e.firebaseUser.uid===e.graph.owner};e.$watch("graph.owner",function(t){var t=e.graph.owner;t&&(e.owner=n(firebase.database().ref("users").child(t)))}),e.$watch("graph.nodes",function(t){e.graphData.nodes.add(t)}),e.setSlug=function(t){e.graph.slug||e.graph.name||l(t),e.graph.slug=t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""),r.search({reason:e.graph.name})},e.auth.$onAuthStateChanged(function(t){e.firebaseUser=t,e.$apply()}),e.graphOptions={interaction:{selectConnectedEdges:!1,hover:!1},nodes:{shape:"box"},height:"400px"},e.selectedNodes=[],e.selectedEdges=[],e.supportingNodes=[],e.supportedNodes=[],e.selectedNodeObjects=[],e.supportingNode=[],e.supportedNode=[],e.search=function(e){q2=r.search(),q2.nodes=e.nodes,q2.edges=e.edges,r.search(q2)},e.removeEdge=function(t){e.graphData.edges.remove(t.id),g({nodes:[],edges:[]},!0)},e.removeNode=function(t){e.graphData.nodes.remove(t.id);var r=e.graphData.edges.get({filter:function(e){return e.to===t.id||e.from===t.id}});e.graphData.edges.remove(r),g({nodes:[],edges:[]},!0)},e.createNode=function(){if(e.graphEditable()){var t=e.graphData.nodes.add({label:"New Node"});e.select({node:t})}else console.log("Attempt to add node to read-only graph")},e.createEdge=function(t,r){var o=e.graphData.edges.add({arrows:"to",from:t.id,to:r.id});return e.showEdgeTarget=!1,o},e.showEdgeTarget=!1,e.toggleEdgeTarget=function(){e.showEdgeTarget=!e.showEdgeTarget},e.showEdgeFrom=!1,e.toggleEdgeFrom=function(){e.showEdgeFrom=!e.showEdgeFrom},e.select=function(e){void 0===e.edge&&void 0!==e.node?g({nodes:[e.node],edges:[]},!0):void 0!==e.edge&&void 0===e.node?g({nodes:[],edges:[e.edge]},!0):console.log("Illlegal selection call. Only node or edge may be defined.",e)},e.events={click:g}}]),angular.module("atheistengineergithubioApp").controller("HeaderCtrl",["$scope","$location",function(e,t){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],e.isActive=function(e){return e===t.path()}}]),angular.module("atheistengineergithubioApp").factory("ReasonFactory",["$firebaseObject","$q",function(e,t){return e.$extend({getOwnerProfile:function(t){if(void 0!==this.owner){console.log("Owner defined",this.owner);var r=firebase.database().ref("users").child(this.owner);return e(r)}},isEditable:function(){if(void 0!==this.owner){var e=null!==firebase.auth().currentUser&&this.owner===firebase.auth().currentUser.uid;return console.log("editable:",e,firebase.auth().currentUser.uid,this.owner,this),e}}})}]).factory("Reason",["ReasonFactory","$q",function(e,t){return function(r){var o=slugify(r),n=firebase.database().ref("reasons"),a=t.defer(),s=n.orderByChild("slug").equalTo(o).limitToFirst(1);return s.once("value",function(t){if(t.exists())console.log("Value Exists",t),t.forEach(function(t){var r=e(t.ref);a.resolve(r)});else{console.log("No Value");var s=firebase.auth().currentUser.uid;void 0===s?console.log("Unknown User."):console.log("Logged in as "+s);var i=n.push();i.set({name:r,slug:o,owner:s,created:(new Date).toString()}),a.resolve(e(i))}}),a.promise}}]),angular.module("atheistengineergithubioApp").factory("Auth",["$firebaseAuth","FUser",function(e,t){var r=e();return r.$onAuthStateChanged(function(e){t(e)}),r}]).factory("FUser",["$firebaseObject",function(e){return function(t){if(null===t)return null;var r=firebase.database().ref().child("users"),o=r.child(t.uid);return o.set({displayName:t.displayName,photoUrl:t.photoURL,lastLogin:{".sv":"timestamp"}}),e(o)}}]);